<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, interactive-widget=resizes-content">
  <meta name="theme-color" content="#131314">
  <title>HPCore Aero8/D</title>
  
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icon.png">

  <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div id="auth-modal" class="auth-overlay">
    <div class="auth-card">
      <div class="auth-header">
        <span class="core-logo rainbow-text">HPCore</span>
      </div>
      
      <div class="auth-tabs">
        <div class="tab active" onclick="switchAuthTab('login')">LOGIN</div>
        <div class="tab" onclick="switchAuthTab('register')">REGISTER</div>
      </div>

      <form id="login-form" class="auth-form active" onsubmit="handleLogin(event)">
        <div class="input-group">
          <input type="text" id="login-id" placeholder="User ID" autocomplete="username" required>
        </div>
        <div class="input-group">
          <input type="password" id="login-pass" placeholder="Password" autocomplete="current-password" required>
        </div>
        <div class="auth-options">
          <label><input type="checkbox" id="remember-me"> Remember me</label>
        </div>
        <button type="submit" class="auth-btn">LOGIN</button>
      </form>

      <form id="register-form" class="auth-form" onsubmit="handleRegister(event)">
        <input type="text" id="reg-id" placeholder="User ID (Unique)" required>
        <input type="text" id="reg-name" placeholder="Display Name" required>
        <input type="email" id="reg-email" placeholder="Email (Auth Code)" required>
        <input type="tel" id="reg-mobile" placeholder="Mobile (Security Alert)" required pattern="[0-9]*">
        <input type="text" id="reg-line" placeholder="LINE ID (Optional)">
        <input type="password" id="reg-pass" placeholder="Password (Min 8 chars)" minlength="8" required>
        <button type="submit" class="auth-btn register-btn">CREATE ACCOUNT</button>
      </form>
    </div>
  </div>

  <div id="mobile-view" class="app-view" style="display:none;">
    <header class="mobile-header sticky-header">
      <div class="header-left">
        <span class="material-symbols-outlined icon-btn" onclick="toggleSidebar(true)">menu</span>
      </div>
      <div class="header-center">
        <span class="core-logo rainbow-text">HPCore</span>
      </div>
      <div class="header-right" onclick="openSettingsModal()">
        <span class="user-name-display" id="mobile-username">Guest</span>
      </div>
    </header>

    <main class="chat-stream" id="mobile-chat-stream">
      <div class="zero-state">
        <h1 class="greeting-text">
          <span class="greeting-name" id="greeting-name">Boss</span>、<br>
          何から始めますか？
        </h1>
      </div>
      <div id="mobile-history-container"></div>
      <div class="stream-spacer"></div>
    </main>

    <footer class="input-dock">
      <div class="capsule-container">
        <div class="capsule-btn plus-btn" onclick="triggerFileUpload()">
          <span class="material-symbols-outlined">add</span>
        </div>
        <textarea id="mobile-input" rows="1" placeholder="Coreに相談" oninput="handleMobileInput(this)"></textarea>
        
        <div class="action-area" id="mobile-action-area">
          <div class="voice-group" id="voice-group">
            <div class="capsule-icon mic-wrapper" id="mobile-mic-btn" onclick="toggleMobileMic()">
              <span class="material-symbols-outlined">mic</span>
              <div class="mic-pulse"></div>
            </div>
            <div class="capsule-icon live-wrapper" onclick="startLiveMode()">
              <img src="https://storage.googleapis.com/logi-app-design/chatbtn.png" alt="Live" class="live-icon-img">
            </div>
          </div>
          <div class="send-group hidden" id="send-group">
            <span class="material-symbols-outlined send-icon" onclick="sendMobileMessage()">send</span>
          </div>
        </div>
      </div>
    </footer>

    <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar(false)"></div>
    <aside class="sidebar-panel" id="sidebar-panel">
      <div class="sidebar-top">
        <div class="new-chat-btn" onclick="resetChat()">
          <span class="material-symbols-outlined">add</span> New Chat
        </div>
      </div>
      <div class="sidebar-middle">
        <div class="sidebar-section-header">最近 (Recent)</div>
        <div id="topic-list" class="topic-list">
          </div>
      </div>
      <div class="sidebar-bottom">
        <div class="sidebar-item" onclick="openSettingsModal()">
          <span class="material-symbols-outlined">settings</span> Settings
        </div>
      </div>
    </aside>
  </div>

  <div id="pc-view" class="app-view" style="display:none;">
    <div class="pc-layout">
      <aside class="pc-sidebar">
        <div class="pc-brand">
          <span class="core-logo rainbow-text small">HPCore v3.0</span>
          <div class="pc-user-info" id="pc-user-info">Boss (Master)</div>
        </div>
        
        <div class="pc-mode-selector">
          <div class="mode-btn active" id="mode-partner" onclick="switchPcMode('partner')">
            <span class="material-symbols-outlined">psychology</span> Partner Mode
          </div>
          <div class="mode-btn" id="mode-librarian" onclick="switchPcMode('librarian')">
            <span class="material-symbols-outlined">construction</span> Librarian Mode
            <div class="mode-glow"></div>
          </div>
        </div>

        <div class="pc-topics-container">
          <div class="sidebar-section-header">Topics</div>
          <div id="pc-topic-list" class="topic-list"></div>
        </div>
      </aside>

      <main class="pc-console">
        <header class="pc-header">
          <div class="header-line-anim"></div>
          <div class="current-mode-label" id="pc-mode-label">Partner Mode</div>
          <div class="pc-header-tools">
            <span class="material-symbols-outlined icon-btn" onclick="togglePcVoiceRead()" id="pc-speaker-btn">volume_up</span>
            <span class="material-symbols-outlined icon-btn" onclick="openSettingsModal()">settings</span>
          </div>
        </header>

        <div class="pc-stream" id="pc-chat-stream">
          </div>

        <div class="pc-input-area">
          <div class="pc-input-wrapper">
            <textarea id="pc-input" placeholder="Command or Chat..." onkeydown="handlePcKeydown(event)"></textarea>
            <div class="pc-input-tools">
              <span class="material-symbols-outlined icon-btn" id="pc-mic-btn" onclick="togglePcMic()">mic</span>
              <span class="material-symbols-outlined icon-btn send-btn" onclick="sendPcMessage()">send</span>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <div id="live-overlay" class="live-overlay">
    <div class="live-header">
      <span class="core-logo rainbow-text live-title">OneCore Live</span>
    </div>
    
    <div class="abyss-container">
      <div class="wave wave1"></div>
      <div class="wave wave2"></div>
      <div class="wave wave3"></div>
    </div>

    <div class="live-controls">
      <div class="live-btn speed-btn" onclick="toggleLiveSpeed()">
        <span id="live-speed-val">x1.0</span>
      </div>
      <div class="live-btn pause-btn" onclick="toggleLivePause()">
        <span class="material-symbols-outlined" id="live-pause-icon">pause</span>
      </div>
      <div class="live-btn close-btn" onclick="stopLiveSession()">
        <span class="material-symbols-outlined">close</span>
      </div>
    </div>
  </div>

  <div id="settings-modal" class="modal-backdrop" onclick="closeSettingsModal(event)">
    <div class="modal-card">
      <h3>Settings</h3>
      <div class="setting-item">
        <label>Voice Gender</label>
        <select id="voice-gender-select">
          <option value="male">Male (Neural2-B)</option>
          <option value="female">Female (Neural2-A)</option>
        </select>
      </div>
      
      <div id="admin-danger-zone" style="display:none; margin-top:20px; border-top:1px solid #444; padding-top:10px;">
        <h4 style="color:#EA4335;">Danger Zone</h4>
        <div class="setting-item">
          <label style="color:#EA4335;">Rule Manager</label>
          <label class="switch">
            <input type="checkbox" id="rule-manager-toggle" onchange="toggleRuleManager(this)">
            <span class="slider"></span>
          </label>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
